@using CustomerSite.Models.ViewModels
@model IEnumerable<Bookstore.Domain.Customers.Address>

@{
    decimal totalprice = 0;
    foreach (var item in ViewData["order"] as List<OrderDetailViewModel>)
    {
        totalprice += item.Price * item.Quantity;
    }
}
<head>
    <meta charset="UTF-8">
    <title>>Book Store</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="theme-color" content="#03a6f3">
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <link rel="stylesheet" href="/css/googlefont.css">
    <link rel="stylesheet" href="/css/font-awesome.min.css">

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/custom-style.css">
</head>

<h1>Finish your order</h1>
<br/>
<br/>
<div class="container" style="text-align: center">

    <ul class="time-horizontal">
        <li style="color:red"><b></b>Cart</li>
        <li style="color:red"><b></b>Choose Address</li>
        <li>
            <p></p>Finish
        </li>

    </ul>
</div>
<br/>
<br/>
<br/>
<body>

<div>
    <h2>Total price :$@totalprice</h2>
</div>

<table class="table">
    <thead>
    <tr>
        <th>

        </th>
        <th>
            Address Line 1
        </th>
        <th>
            Address Line 2
        </th>
        <th>
            City
        </th>
        <th>
            State
        </th>
        <th>
            Country
        </th>
        <th>
            ZipCode
        </th>
        <th></th>
    </tr>
    </thead>
    <tbody>
    @using (Html.BeginForm(new { action = "ConfirmOrderAddress" }))
    {
        @foreach (var item in Model)
        {
                    @if (item.IsPrimary || item == Model.First())
            {
                <tr>
                    <td>
                        <input type="radio" id="primary" name="addressID" value="@Html.DisplayFor(modelItem => item.Address_Id)" checked onchange="toggleSubmitButton()"/>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AddressLine1)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AddressLine2)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.City)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.State)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Country)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.ZipCode)
                    </td>
                    <td>
                        <a id="PrimaryAddressEdit" asp-area="Identity" asp-page="/Account/Manage/PrimaryAddressEdit">Edit</a>
                    </td>
                </tr>
            }
            else
            {
                <tr>
                    <td>
                        <input type="radio" id="primary" name="addressID" value="@Html.DisplayFor(modelItem => item.Address_Id)"/>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AddressLine1)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AddressLine2)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.City)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.State)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Country)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.ZipCode)
                    </td>
                    <td>
                        <a asp-action="EditAddress" asp-route-id="@item.Address_Id">Edit</a>

                    </td>
                </tr>
            }
        }
        <input type="hidden" name="OrderId" value="@ViewData["orderId"]"/>
                @if (Model.Count() == 0)
                {
                    <input type="submit" value="Finish your order" class = "btn" disabled/>
                    <p style="color:red"> Add an Address to proceed to checkout </p>
                }
                else
                {
                    <input type="submit" value="Finish your order" class = "btn" />
                    
                }
            }
    </tbody>


</table>
<div>
    <p style="text-align: center">
        <a asp-action="AddAddressAtCheckout">Add address</a>
    </p>
</div>
<table class="table">
    <thead>
    <tr>
        <th>
            Cover
        </th>
        <th>
            name
        </th>
        <th>
            price
        </th>
        <th>quantity</th>
        <th>total</th>
    </tr>
    </thead>
    <tbody>
    @foreach (var item in ViewData["order"] as List<OrderDetailViewModel>)
    {
        var total = item.Price * item.Quantity;
        <tr>
            <td>
                <img src="@item.Url" height="80" width="50" onerror="this.onerror=null;this.src='/images/default_c.jpg';"/>
            </td>
            <td>
                @item.Bookname
            </td>

            <td>
                $@item.Price
            </td>

            <td>
                @item.Quantity
            </td>

            <td>
                $@total
            </td>
        </tr>
    }
    </tbody>
</table>

@*<script>
    toggleSubmitButton = () => {
        console.log(document.getElementById("primary"))
        document.getElementById("btnId").disbled = false
    }
</script>*@
</body>

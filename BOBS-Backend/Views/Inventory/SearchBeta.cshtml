@model BOBS_Backend.ViewModel.ManageInventory.PagedSearchViewModel;
@{
    ViewData["Title"] = "Checkout";
    var types = (List<BOBS_Backend.Models.Book.Type>)ViewData["Types"];
    var publishers = (List<BOBS_Backend.Models.Book.Publisher>)ViewData["Publishers"];
    var genres = (List<BOBS_Backend.Models.Book.Genre>)ViewData["Genres"];
    var conditions = (List<BOBS_Backend.Models.Book.Condition>)ViewData["Conditions"];
    var count = @Model.Books.Count();
    var viewstyle = Model.ViewStyle;

}
<style>

    .table-hover tbody tr:hover td, .table-hover tbody tr:hover th 
    {
        background-color: #e8e4f2;
        
        
    }

    .btn-outline-secondary
    {
        color : #ffffff;
        border-color :#ffffff;
        border-radius : .5rem;
        background-color :#7D53DE;
        
    }

    .text {
        color: #7D53DE;
        font-family: 'Arvo', serif
    }

    .website-text {
        font-family: 'Arvo', serif;
    }
    .container h2 h3 h4 h5 p {
        font-family: 'Arvo', serif
    }

    .main-text {
        font-family: 'Arvo', serif
    }
</style>


<div class="container">
    <div class="text-center">
        <h1 class="text-center" style="margin-top:35px">
            <span class="title-1 text-center font-weight-light" style="margin-bottom: 45px">Search Books</span>
        </h1>
    </div>
    <div class="row" style="margin:15px;">
        <div class="col-12">

            <form enctype="multipart/form-data" class="input-group mb-3" asp-controller="Inventory" asp-action="SearchBeta" method="get" style="padding-bottom: 0px;">
                <select class="main-text col-2 custom-select title-1 text-center font-weight-light " id="inputGroupSelect01" asp-for="searchby">
                    <option selected value="">Filter By</option>
                    <option value="Book.Name">Book Name</option>
                    <option value="Book.Publisher.Name">Publisher</option>
                    <option value="Book.Genre.Name">Genre</option>
                    <option value="Condition.ConditionName">Condition</option>
                    <option value="Book.Type.TypeName">Type</option>
                </select>
                <input id="tags" type="text" asp-page-handler="@Model.searchby" asp-for="searchfilter" placeholder="Please , Enter the search query" class=" main-text form-control bg-light text-dark font-weight-light" aria-label="Text input with dropdown button">
                @section Scripts{
                    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
                    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
                    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
                    <script>
                        $(function () {
                            $("#tags").autocomplete({
                                source: '/Inventory/AutoSuggest'
                            });
                        });
                    </script>
                }
                <select class="main-text col-2 custom-select title-1 text-center font-weight-light " id="inputGroupSelect01" asp-for="ViewStyle">
                    <option value="Grid">Grid</option>
                    <option value="Tabular">Tabular</option>
                </select>
                <button class="main-text btn btn-outline-secondary title-1 text-center font-weight-light  " type="submit">Submit</button>
            </form>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-12 col-sm-3">
            <div class="card bg-light mb-3">
                <div class="main-text card-header  text-white text-uppercase text-center " style="background-color: #7D53DE">Best Selling Book</div>
                <div class="card-body">
                    <img class="img-fluid" src="" />
                    <h5 class="main-text card-title text-center">@ViewData["name"]</h5>
                    <p class="card-text"></p>
                </div>
            </div>
            <div class="card bg-light mb-3">
                <div class="main-text card-header  text-white text-uppercase text-center " style="background-color: #7D53DE">Best Selling Publisher</div>
                <div class="card-body">
                    <img class="img-fluid" src="" />
                    <h5 class="main-text card-title text-center">@ViewData["publisher"]</h5>
                    <p class="card-text"></p>
                </div>
            </div>
            <div class="card bg-light mb-3">
                <div class="main-text card-header  text-white text-uppercase text-center " style="background-color: #7D53DE">Best Selling Format</div>
                <div class="card-body">
                    <img class="img-fluid" src="" />
                    <h5 class="main-text card-title text-center">@ViewData["type"]</h5>
                    <p class="card-text"></p>
                </div>
            </div>
            <div class="card bg-light mb-3">
                <div class="main-text card-header  text-white text-uppercase text-center " style="background-color: #7D53DE">Best Selling Genre</div>
                <div class="card-body">
                    <img class="img-fluid" src="" />
                    <h5 class="main-text card-title text-center">@ViewData["genre"]</h5>
                    <p class="card-text"></p>
                </div>
            </div>
        </div>
        @if (count != 0)
        {

            <div class="col">
                <div class="row">
                    @if (viewstyle == "Grid")
                    {
                        @foreach (var book in Model.Books)
                        {
                            var param = new Dictionary<string, string>
                            { 
                                {"BookId",book.BookId + ""}
                             };

                            <div class="col-12 col-md-6 col-lg-4">
                                <div class="card">
                                        @if(!String.IsNullOrEmpty(@book.front_url))
                                        {
                                            <img class="card-img-top" src="@book.front_url" alt="Card image cap"> 
                                        }

                                        else if (!String.IsNullOrEmpty(@book.back_url))
                                        {
                                            <img class="card-img-top" src="@book.back_url" alt="Card image cap">
                                        }

                                        else if (!String.IsNullOrEmpty(@book.left_url))
                                        {
                                            <img class="card-img-top" src="@book.left_url" alt="Card image cap">
                                        }

                                        else if (!String.IsNullOrEmpty(@book.right_url))
                                        {
                                            <img class="card-img-top" src="@book.right_url" alt="Card image cap">
                                        }

                                        else
                                        {
                                            <img style="width:100%;height:100%" img-fluid" src="https://dtdt6j0vhq1rq.cloudfront.net/default0Kind of New.jpg" alt="Ft slide">
                                        }
                                        <div class="main-text card-body">
                                            <h4 class="card-title text-center">
                                                <a asp-controller="Inventory" asp-action="BookDetails" asp-all-route-data="param" style="text-emphasis-color: #FC4A1A">@book.BookName</a>
                                            </h4>
                                            <p class="main-text card-text  text-center" style="  font-style:'arovo', serif">@book.Author</p>
                                            <div class="row">
                                                <div class="col">
                                                    @{
                                                        var price = (int)book.Price;
                                                    }
                                                    <p class="main-text btn text-white btn-block" style="   background-color: #7D53DE">@price $</p>
                                                </div>
                                                <div class="col">
                                                    <a href="#" class="main-text btn text-white btn-block" style="    background-color: #7D53DE">@book.Quantity units</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                            </div>
                        }
                    }

                    else
                    {

  //table-striped                    
                        <table id="mytable" class="table table-hover "> 
                            <thead>
                            <th>               
                                @{
                                    var SortBy = new Dictionary<string, string>
                                                                        {
                                        {"searchfilter",Model.searchfilter},
                                        {"searchby",Model.searchby},
                                        {"SortBy","Sort Book.Name"},
                                        {"pageNum",Model.CurrentPage+""},
                                        {"style",Model.ViewStyle},
                                        {"ascdesc",Model.Ascdesc}
                                        };
                                   <a class = "main-text text font-weight-light" asp-controller="Inventory" asp-action="SearchBeta" asp-all-route-data="SortBy">BookName ▲</a>
                                }
                            </th>
                            <th>                                
                                @{
                                    var Sort = new Dictionary<string, string>
                                                                            {
                                        {"searchfilter",Model.searchfilter},
                                        {"searchby",Model.searchby},
                                        {"SortBy","Sort Book.Author"},
                                        {"pageNum",Model.CurrentPage+""},
                                        {"style",Model.ViewStyle},
                                        {"ascdesc",Model.Ascdesc}

                                        };

                                       <a class = "main-text text font-weight-light" asp-controller="Inventory" asp-action="SearchBeta" asp-all-route-data="Sort">Author  ▲ </a>
                                }
                            </th>
                            <th>
                                @{
                                    var sort = new Dictionary<string, string>
                                                                            {
                                        {"searchfilter",Model.searchfilter},
                                        {"searchby",Model.searchby},
                                        {"SortBy","Sort ItemPrice"},
                                        {"pageNum",Model.CurrentPage+""},
                                        {"style",Model.ViewStyle},
                                        {"ascdesc",Model.Ascdesc}
                                        };

                                      <a class = "main-text text font-weight-light" asp-controller="Inventory" asp-action="SearchBeta" asp-all-route-data="sort"> Price ▲ </a>
                                }
                            </th>
                            <th>                               
                                @{
                                    var sortby = new Dictionary<string, string>
                                                                            {
                                        {"searchfilter",Model.searchfilter},
                                        {"searchby",Model.searchby},
                                        {"SortBy","Sort Quantity"},
                                        {"pageNum",Model.CurrentPage+""},
                                        {"style",Model.ViewStyle},
                                        {"ascdesc",Model.Ascdesc}
                                        };

                                      <a class = "main-text text font-weight-light" asp-controller="Inventory" asp-action="SearchBeta" asp-all-route-data="sortby"> Quantity ▲</a>
                                }
                            </th>
                            </thead>
                            <tbody>
                                @foreach (var book in Model.Books)
                                {
                                    var param = new Dictionary<string, string>
                                                                                                                                          {
                                                {"BookId",book.BookId + ""}
                                                              };
                                    <tr>
                                        @{ 
                                            var price = (int)book.Price;
                                        }
                                        <td class="main-text">@book.BookName</td>
                                        <td class="main-text">@book.Author</td>
                                        <td class="main-text">$@price</td>
                                        <td class="main-text">@book.Quantity</td>
                                        <td>
                                            <a class="main-text" asp-controller="Inventory" asp-action="BookDetails" asp-all-route-data="param">View</a>
                                        </td>
                                    </tr>
                                }

                            </tbody>
                        </table>


                    }
                </div>
            </div>
        }
        else
        { <h3 class="text-center font-weight-light text-primary">Sorry , Could'nt find any relevant books. Try again !!</h3>

        }
    </div>
</div>
<div class="row d-flex justify-content-lg-center">
    <div class="row d-flex justify-content-center" style="margin-top:35px;">

        <partial name="./Partials/_Pagination" model="Model" />
    </div>
</div>